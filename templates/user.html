<!DOCTYPE html>
<html>
<head>
    <title>Student Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

<div class="dashboard">

    <!-- SIDEBAR -->
    <div class="sidebar">
        <h2>Student Panel</h2>
        <a href="/user">Circulars</a>
        <a href="/stats">Stats</a>
        <a href="/profile">Profile</a>
        <a href="/logout">Logout</a>
    </div>

    <!-- MAIN CONTENT -->
    <div class="main-content">

        <h2>Circulars</h2>

        <!-- SORT OPTION -->
        <form method="get">
            <select name="sort" onchange="this.form.submit()">
                <option value="new">Newest First</option>
                <option value="old">Oldest First</option>
            </select>
        </form>

        {% for circular in circulars %}
<div class="card">

    <h3>{{ circular[1] }}</h3>
    <p>{{ circular[2] }}</p>

    {% if circular[3] == 'urgent' %}
        <span class="badge urgent">Urgent</span>
    {% elif circular[3] == 'medium' %}
        <span class="badge medium">Medium</span>
    {% else %}
        <span class="badge normal">Normal</span>
    {% endif %}

    <br><br>

    <a href="/mark_read/{{ circular[0] }}">
        <button>Mark as Read</button>
    </a>

</div>
{% endfor %}

    <!-- FEEDBACK/COMMENT SECTION -->
    <div class="card" style="margin-top: 40px;">
        <h2>Feedback & Comments</h2>
        
        <!-- Add Comment Form -->
        <form method="POST" action="/add_feedback">
            <textarea name="comment" placeholder="Share your feedback or comments..." required style="width: 100%; height: 100px; padding: 10px; font-family: Arial;"></textarea>
            <button type="submit" style="margin-top: 10px;">Post Comment</button>
        </form>

        <hr style="margin: 20px 0;">

        <!-- Display Comments -->
        <h3>Recent Feedback</h3>
        {% if feedbacks %}
            {% for feedback in feedbacks %}
            <div style="border-left: 4px solid #007bff; padding: 10px; margin: 10px 0; background-color: #f9f9f9;">
                <p><strong>{{ feedback[3] }}</strong> <small style="color: #666;">{{ feedback[4] }}</small></p>
                <p>{{ feedback[2] }}</p>
            </div>
            {% endfor %}
        {% else %}
            <p style="color: #999;">No feedback yet. Be the first to comment!</p>
        {% endif %}
    </div>

    </div>

</div>

</body>
</html>
